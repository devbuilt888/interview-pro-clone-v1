(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[661],{3222:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Image",{enumerable:!0,get:function(){return m}});let r=n(1024),o=n(8533),i=o._(n(2265)),a=n(4887),u=r._(n(2912)),l=n(2301),c=n(7709),s=n(9469);n(7873);let f=n(2706),d=r._(n(5033)),p={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function h(e,t,n,r,o,i){let a=null==e?void 0:e.src;if(!e||e["data-loaded-src"]===a)return;e["data-loaded-src"]=a;let u="decode"in e?e.decode():Promise.resolve();u.catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&o(!0),null==n?void 0:n.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let r=!1,o=!1;n.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>r,isPropagationStopped:()=>o,persist:()=>{},preventDefault:()=>{r=!0,t.preventDefault()},stopPropagation:()=>{o=!0,t.stopPropagation()}})}(null==r?void 0:r.current)&&r.current(e)}})}function y(e){let[t,n]=i.version.split("."),r=parseInt(t,10),o=parseInt(n,10);return r>18||18===r&&o>=3?{fetchPriority:e}:{fetchpriority:e}}let v=(0,i.forwardRef)((e,t)=>{let{src:n,srcSet:r,sizes:o,height:a,width:u,decoding:l,className:c,style:s,fetchPriority:f,placeholder:d,loading:p,unoptimized:v,fill:b,onLoadRef:m,onLoadingCompleteRef:g,setBlurComplete:w,setShowAltText:_,onLoad:S,onError:E,...T}=e;return i.default.createElement("img",{...T,...y(f),loading:p,width:u,height:a,decoding:l,"data-nimg":b?"fill":"1",className:c,style:s,sizes:o,srcSet:r,src:n,ref:(0,i.useCallback)(e=>{t&&("function"==typeof t?t(e):"object"==typeof t&&(t.current=e)),e&&(E&&(e.src=e.src),e.complete&&h(e,d,m,g,w,v))},[n,d,m,g,w,E,v,t]),onLoad:e=>{let t=e.currentTarget;h(t,d,m,g,w,v)},onError:e=>{_(!0),"empty"!==d&&w(!0),E&&E(e)}})});function b(e){let{isAppRouter:t,imgAttributes:n}=e,r={as:"image",imageSrcSet:n.srcSet,imageSizes:n.sizes,crossOrigin:n.crossOrigin,referrerPolicy:n.referrerPolicy,...y(n.fetchPriority)};return t&&a.preload?((0,a.preload)(n.src,r),null):i.default.createElement(u.default,null,i.default.createElement("link",{key:"__nimg-"+n.src+n.srcSet+n.sizes,rel:"preload",href:n.srcSet?void 0:n.src,...r}))}let m=(0,i.forwardRef)((e,t)=>{let n=(0,i.useContext)(f.RouterContext),r=(0,i.useContext)(s.ImageConfigContext),o=(0,i.useMemo)(()=>{let e=p||r||c.imageConfigDefault,t=[...e.deviceSizes,...e.imageSizes].sort((e,t)=>e-t),n=e.deviceSizes.sort((e,t)=>e-t);return{...e,allSizes:t,deviceSizes:n}},[r]),{onLoad:a,onLoadingComplete:u}=e,h=(0,i.useRef)(a);(0,i.useEffect)(()=>{h.current=a},[a]);let y=(0,i.useRef)(u);(0,i.useEffect)(()=>{y.current=u},[u]);let[m,g]=(0,i.useState)(!1),[w,_]=(0,i.useState)(!1),{props:S,meta:E}=(0,l.getImgProps)(e,{defaultLoader:d.default,imgConf:o,blurComplete:m,showAltText:w});return i.default.createElement(i.default.Fragment,null,i.default.createElement(v,{...S,unoptimized:E.unoptimized,placeholder:E.placeholder,fill:E.fill,onLoadRef:h,onLoadingCompleteRef:y,setBlurComplete:g,setShowAltText:_,ref:t}),E.priority?i.default.createElement(b,{isAppRouter:!n,imgAttributes:S}):null)});("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7555:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AmpStateContext",{enumerable:!0,get:function(){return i}});let r=n(1024),o=r._(n(2265)),i=o.default.createContext({})},8551:function(e,t){"use strict";function n(e){let{ampFirst:t=!1,hybrid:n=!1,hasQuery:r=!1}=void 0===e?{}:e;return t||n&&r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isInAmpMode",{enumerable:!0,get:function(){return n}})},2301:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImgProps",{enumerable:!0,get:function(){return u}}),n(7873);let r=n(9540),o=n(7709);function i(e){return void 0!==e.default}function a(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function u(e,t){var n;let u,l,c,{src:s,sizes:f,unoptimized:d=!1,priority:p=!1,loading:h,className:y,quality:v,width:b,height:m,fill:g=!1,style:w,onLoad:_,onLoadingComplete:S,placeholder:E="empty",blurDataURL:T,fetchPriority:k,layout:x,objectFit:C,objectPosition:O,lazyBoundary:P,lazyRoot:j,...R}=e,{imgConf:I,showAltText:A,blurComplete:L,defaultLoader:M}=t,N=I||o.imageConfigDefault;if("allSizes"in N)u=N;else{let e=[...N.deviceSizes,...N.imageSizes].sort((e,t)=>e-t),t=N.deviceSizes.sort((e,t)=>e-t);u={...N,allSizes:e,deviceSizes:t}}let U=R.loader||M;delete R.loader,delete R.srcSet;let D="__next_img_default"in U;if(D){if("custom"===u.loader)throw Error('Image with src "'+s+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader')}else{let e=U;U=t=>{let{config:n,...r}=t;return e(r)}}if(x){"fill"===x&&(g=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[x];e&&(w={...w,...e});let t={responsive:"100vw",fill:"100vw"}[x];t&&!f&&(f=t)}let Q="",F=a(b),z=a(m);if("object"==typeof(n=s)&&(i(n)||void 0!==n.src)){let e=i(s)?s.default:s;if(!e.src)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(e));if(!e.height||!e.width)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(e));if(l=e.blurWidth,c=e.blurHeight,T=T||e.blurDataURL,Q=e.src,!g){if(F||z){if(F&&!z){let t=F/e.width;z=Math.round(e.height*t)}else if(!F&&z){let t=z/e.height;F=Math.round(e.width*t)}}else F=e.width,z=e.height}}let V=!p&&("lazy"===h||void 0===h);(!(s="string"==typeof s?s:Q)||s.startsWith("data:")||s.startsWith("blob:"))&&(d=!0,V=!1),u.unoptimized&&(d=!0),D&&s.endsWith(".svg")&&!u.dangerouslyAllowSVG&&(d=!0),p&&(k="high");let W=a(v),$=Object.assign(g?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:C,objectPosition:O}:{},A?{}:{color:"transparent"},w),J=L||"empty"===E?null:"blur"===E?'url("data:image/svg+xml;charset=utf-8,'+(0,r.getImageBlurSvg)({widthInt:F,heightInt:z,blurWidth:l,blurHeight:c,blurDataURL:T||"",objectFit:$.objectFit})+'")':'url("'+E+'")',B=J?{backgroundSize:$.objectFit||"cover",backgroundPosition:$.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:J}:{},G=function(e){let{config:t,src:n,unoptimized:r,width:o,quality:i,sizes:a,loader:u}=e;if(r)return{src:n,srcSet:void 0,sizes:void 0};let{widths:l,kind:c}=function(e,t,n){let{deviceSizes:r,allSizes:o}=e;if(n){let e=/(^|\s)(1?\d?\d)vw/g,t=[];for(let r;r=e.exec(n);r)t.push(parseInt(r[2]));if(t.length){let e=.01*Math.min(...t);return{widths:o.filter(t=>t>=r[0]*e),kind:"w"}}return{widths:o,kind:"w"}}if("number"!=typeof t)return{widths:r,kind:"w"};let i=[...new Set([t,2*t].map(e=>o.find(t=>t>=e)||o[o.length-1]))];return{widths:i,kind:"x"}}(t,o,a),s=l.length-1;return{sizes:a||"w"!==c?a:"100vw",srcSet:l.map((e,r)=>u({config:t,src:n,quality:i,width:e})+" "+("w"===c?e:r+1)+c).join(", "),src:u({config:t,src:n,quality:i,width:l[s]})}}({config:u,src:s,unoptimized:d,width:F,quality:W,sizes:f,loader:U}),Y={...R,loading:V?"lazy":h,fetchPriority:k,width:F,height:z,decoding:"async",className:y,style:{...$,...B},sizes:G.sizes,srcSet:G.srcSet,src:G.src},q={unoptimized:d,priority:p,placeholder:E,fill:g};return{props:Y,meta:q}}},2912:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{defaultHead:function(){return s},default:function(){return h}});let r=n(1024),o=n(8533),i=o._(n(2265)),a=r._(n(2378)),u=n(7555),l=n(1330),c=n(8551);function s(e){void 0===e&&(e=!1);let t=[i.default.createElement("meta",{charSet:"utf-8"})];return e||t.push(i.default.createElement("meta",{name:"viewport",content:"width=device-width"})),t}function f(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===i.default.Fragment?e.concat(i.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}n(7873);let d=["name","httpEquiv","charSet","itemProp"];function p(e,t){let{inAmpMode:n}=t;return e.reduce(f,[]).reverse().concat(s(n).reverse()).filter(function(){let e=new Set,t=new Set,n=new Set,r={};return o=>{let i=!0,a=!1;if(o.key&&"number"!=typeof o.key&&o.key.indexOf("$")>0){a=!0;let t=o.key.slice(o.key.indexOf("$")+1);e.has(t)?i=!1:e.add(t)}switch(o.type){case"title":case"base":t.has(o.type)?i=!1:t.add(o.type);break;case"meta":for(let e=0,t=d.length;e<t;e++){let t=d[e];if(o.props.hasOwnProperty(t)){if("charSet"===t)n.has(t)?i=!1:n.add(t);else{let e=o.props[t],n=r[t]||new Set;("name"!==t||!a)&&n.has(e)?i=!1:(n.add(e),r[t]=n)}}}}return i}}()).reverse().map((e,t)=>{let r=e.key||t;if(!n&&"link"===e.type&&e.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some(t=>e.props.href.startsWith(t))){let t={...e.props||{}};return t["data-href"]=t.href,t.href=void 0,t["data-optimized-fonts"]=!0,i.default.cloneElement(e,t)}return i.default.cloneElement(e,{key:r})})}let h=function(e){let{children:t}=e,n=(0,i.useContext)(u.AmpStateContext),r=(0,i.useContext)(l.HeadManagerContext);return i.default.createElement(a.default,{reduceComponentsToState:p,headManager:r,inAmpMode:(0,c.isInAmpMode)(n)},t)};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9540:function(e,t){"use strict";function n(e){let{widthInt:t,heightInt:n,blurWidth:r,blurHeight:o,blurDataURL:i,objectFit:a}=e,u=r?40*r:t,l=o?40*o:n,c=u&&l?"viewBox='0 0 "+u+" "+l+"'":"";return"%3Csvg xmlns='http://www.w3.org/2000/svg' "+c+"%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='"+(c?"none":"contain"===a?"xMidYMid":"cover"===a?"xMidYMid slice":"none")+"' style='filter: url(%23b);' href='"+i+"'/%3E%3C/svg%3E"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImageBlurSvg",{enumerable:!0,get:function(){return n}})},9469:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ImageConfigContext",{enumerable:!0,get:function(){return a}});let r=n(1024),o=r._(n(2265)),i=n(7709),a=o.default.createContext(i.imageConfigDefault)},7709:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{VALID_LOADERS:function(){return n},imageConfigDefault:function(){return r}});let n=["default","imgix","cloudinary","akamai","custom"],r={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"inline",remotePatterns:[],unoptimized:!1}},1295:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{default:function(){return c},unstable_getImgProps:function(){return l}});let r=n(1024),o=n(2301),i=n(7873),a=n(3222),u=r._(n(5033)),l=e=>{(0,i.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:t}=(0,o.getImgProps)(e,{defaultLoader:u.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,n]of Object.entries(t))void 0===n&&delete t[e];return{props:t}},c=a.Image},5033:function(e,t){"use strict";function n(e){let{config:t,src:n,width:r,quality:o}=e;return t.path+"?url="+encodeURIComponent(n)+"&w="+r+"&q="+(o||75)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}}),n.__next_img_default=!0;let r=n},2706:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return i}});let r=n(1024),o=r._(n(2265)),i=o.default.createContext(null)},2378:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return u}});let r=n(8533),o=r._(n(2265)),i=o.useLayoutEffect,a=o.useEffect;function u(e){let{headManager:t,reduceComponentsToState:n}=e;function r(){if(t&&t.mountedInstances){let r=o.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(n(r,e))}}return i(()=>{var n;return null==t||null==(n=t.mountedInstances)||n.add(e.children),()=>{var n;null==t||null==(n=t.mountedInstances)||n.delete(e.children)}}),i(()=>(t&&(t._pendingUpdate=r),()=>{t&&(t._pendingUpdate=r)})),a(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},7873:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"warnOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},7957:function(){},622:function(e,t,n){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(2265),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,s=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(s=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:s,props:i,_owner:u.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},7437:function(e,t,n){"use strict";e.exports=n(622)},6691:function(e,t,n){e.exports=n(1295)},5566:function(e){var t,n,r,o=e.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function u(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var l=[],c=!1,s=-1;function f(){c&&r&&(c=!1,r.length?l=r.concat(l):s=-1,l.length&&d())}function d(){if(!c){var e=u(f);c=!0;for(var t=l.length;t;){for(r=l,l=[];++s<t;)r&&r[s].run();s=-1,t=l.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||u(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}},1853:function(e,t,n){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(2265),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=r.useState,a=r.useEffect,u=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(e){return!0}}var s="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),o=r[0].inst,s=r[1];return u(function(){o.value=n,o.getSnapshot=t,c(o)&&s({inst:o})},[e,n,t]),a(function(){return c(o)&&s({inst:o}),e(function(){c(o)&&s({inst:o})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:s},6272:function(e,t,n){"use strict";e.exports=n(1853)},3078:function(e,t,n){"use strict";n.d(t,{R:function(){return s}});var r=n(2265),o=n(5938),i=n(3905),a=n(7566),u="object"==typeof o.ac&&o.ac&&o.ac.Object===Object&&o.ac,l="object"==typeof self&&self&&self.Object===Object&&self;u||l||Function("return this")(),Object.prototype.toString;let c=r.forwardRef(function({trackRef:e,onSubscriptionStatusChanged:t,volume:n,...u},l){let c=(0,o.i)(e),s=r.useRef(null);r.useImperativeHandle(l,()=>s.current);let{elementProps:f,isSubscribed:d,track:p,publication:h}=function(e,t={}){let[n,i]=r.useState((0,o.X)(e)),[u,l]=r.useState(null==n?void 0:n.isMuted),[c,s]=r.useState(null==n?void 0:n.isSubscribed),[f,d]=r.useState(null==n?void 0:n.track),[p,h]=r.useState("landscape"),y=r.useRef(),{className:v,trackObserver:b}=r.useMemo(()=>(0,o.Y)(e),[e.participant.sid??e.participant.identity,e.source,(0,o.a1)(e)&&e.publication.trackSid]);return r.useEffect(()=>{let e=b.subscribe(e=>{o.l.debug("update track",e),i(e),l(null==e?void 0:e.isMuted),s(null==e?void 0:e.isSubscribed),d(null==e?void 0:e.track)});return()=>null==e?void 0:e.unsubscribe()},[b]),r.useEffect(()=>{var n,r;return f&&(y.current&&f.detach(y.current),null!=(n=t.element)&&n.current&&!(e.participant.isLocal&&(null==f?void 0:f.kind)==="audio")&&f.attach(t.element.current)),y.current=null==(r=t.element)?void 0:r.current,()=>{y.current&&(null==f||f.detach(y.current))}},[f,t.element]),r.useEffect(()=>{var e,t;if("number"==typeof(null==(e=null==n?void 0:n.dimensions)?void 0:e.width)&&"number"==typeof(null==(t=null==n?void 0:n.dimensions)?void 0:t.height)){let e=n.dimensions.width>n.dimensions.height?"landscape":"portrait";h(e)}},[n]),{publication:n,isMuted:u,isSubscribed:c,track:f,elementProps:(0,a.a)(t.props,{className:v,"data-lk-local-participant":e.participant.isLocal,"data-lk-source":null==n?void 0:n.source,...(null==n?void 0:n.kind)==="video"&&{"data-lk-orientation":p}})}}(c,{element:s,props:u});return r.useEffect(()=>{null==t||t(!!d)},[d,t]),r.useEffect(()=>{void 0===p||void 0===n||(p instanceof i.rl?p.setVolume(n):o.l.warn("Volume can only be set on remote audio tracks."))},[n,p]),r.useEffect(()=>{void 0===h||void 0===u.muted||(h instanceof i.E8?h.setEnabled(!u.muted):o.l.warn("Can only call setEnabled on remote track publications."))},[u.muted,h,p]),r.createElement("audio",{ref:s,...f})});function s({volume:e,muted:t}){let n=(function(e=[i.fQ.Source.Camera,i.fQ.Source.Microphone,i.fQ.Source.ScreenShare,i.fQ.Source.ScreenShareAudio,i.fQ.Source.Unknown],t={}){let n=(0,o.u)(t.room),[a,u]=r.useState([]),[l,c]=r.useState([]),s=r.useMemo(()=>e.map(e=>(0,o.U)(e)?e.source:e),[JSON.stringify(e)]);return r.useEffect(()=>{let e=(0,o.V)(n,s,{additionalRoomEvents:t.updateOnlyOn,onlySubscribed:t.onlySubscribed}).subscribe(({trackReferences:e,participants:t})=>{o.l.debug("setting track bundles",e,t),u(e),c(t)});return()=>e.unsubscribe()},[n,JSON.stringify(t.onlySubscribed),JSON.stringify(t.updateOnlyOn),JSON.stringify(e)]),r.useMemo(()=>{if(!(0,o.W)(e))return a;{let t=function(e,t){let n=new Map;if((0,o.W)(e)){let r=e.filter(e=>e.withPlaceholder).map(e=>e.source);t.forEach(e=>{let t=e.getTrackPublications().map(e=>{var t;return null==(t=e.track)?void 0:t.source}).filter(e=>void 0!==e),o=Array.from(function(e,t){let n=new Set(e);for(let e of t)n.delete(e);return n}(new Set(r),new Set(t)));o.length>0&&n.set(e.identity,o)})}return n}(e,l),n=Array.from(a);return l.forEach(e=>{t.has(e.identity)&&(t.get(e.identity)??[]).forEach(t=>{a.find(({participant:n,publication:r})=>e.identity===n.identity&&r.source===t)||(o.l.debug(`Add ${t} placeholder for participant ${e.identity}.`),n.push({participant:e,source:t}))})}),n}},[a,l,e])})([i.fQ.Source.Microphone,i.fQ.Source.ScreenShareAudio,i.fQ.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0}).filter(e=>!e.participant.isLocal&&e.publication.kind===i.fQ.Kind.Audio);return r.createElement("div",{style:{display:"none"}},n.map(n=>r.createElement(c,{key:(0,o.p)(n),trackRef:n,volume:e,muted:t})))}},5938:function(e,t,n){"use strict";n.d(t,{L:function(){return eP},R:function(){return eC},U:function(){return ev},V:function(){return eS},W:function(){return eb},X:function(){return eg},Y:function(){return em},a1:function(){return ed},ac:function(){return u},i:function(){return ex},l:function(){return ey},p:function(){return ep},s:function(){return ew},u:function(){return eO}});var r,o,i=n(3905),a=n(2265),u="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof global?global:"u">typeof self?self:{},l={exports:{}};r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],o={},i=null;function a(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch{return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function u(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(){for(var n=this.getLevel(),o=0;o<r.length;o++){var i=r[o];this[i]=o<n?e:this.methodFactory(i,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function c(e){return function(){typeof console!==t&&(l.call(this),this[e].apply(this,arguments))}}function s(r,o,i){var l;return"debug"===(l=r)&&(l="log"),typeof console!==t&&("trace"===l&&n?u:void 0!==console[l]?a(console,l):void 0!==console.log?a(console,"log"):e)||c.apply(this,arguments)}function f(e,n){var a,u,c,f=this,d="loglevel";function p(){var e;if(!(typeof window===t||!d)){try{e=window.localStorage[d]}catch{}if(typeof e===t)try{var n=window.document.cookie,r=encodeURIComponent(d),o=n.indexOf(r+"=");-1!==o&&(e=/^([^;]+)/.exec(n.slice(o+r.length+1))[1])}catch{}return void 0===f.levels[e]&&(e=void 0),e}}function h(e){var t=e;if("string"==typeof t&&void 0!==f.levels[t.toUpperCase()]&&(t=f.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=f.levels.SILENT)return t;throw TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?d+=":"+e:"symbol"==typeof e&&(d=void 0),f.name=e,f.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},f.methodFactory=n||s,f.getLevel=function(){return c??u??a},f.setLevel=function(e,n){return c=h(e),!1!==n&&function(e){var n=(r[e]||"silent").toUpperCase();if(!(typeof window===t||!d)){try{window.localStorage[d]=n;return}catch{}try{window.document.cookie=encodeURIComponent(d)+"="+n+";"}catch{}}}(c),l.call(f)},f.setDefaultLevel=function(e){u=h(e),p()||f.setLevel(e,!1)},f.resetLevel=function(){c=null,function(){if(!(typeof window===t||!d)){try{window.localStorage.removeItem(d)}catch{}try{window.document.cookie=encodeURIComponent(d)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}(),l.call(f)},f.enableAll=function(e){f.setLevel(f.levels.TRACE,e)},f.disableAll=function(e){f.setLevel(f.levels.SILENT,e)},f.rebuild=function(){if(i!==f&&(a=h(i.getLevel())),l.call(f),i===f)for(var e in o)o[e].rebuild()},a=h(i?i.getLevel():"WARN");var y=p();null!=y&&(c=h(y)),l.call(f)}(i=new f).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw TypeError("You must supply a name when creating a logger.");var t=o[e];return t||(t=o[e]=new f(e,i.methodFactory)),t};var d=typeof window!==t?window.log:void 0;return i.noConflict=function(){return typeof window!==t&&window.log===i&&(window.log=d),i},i.getLoggers=function(){return o},i.default=i,i},l.exports?l.exports=r():u.log=r();var c=l.exports;let s=c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c;var f=function(e,t){return(f=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function d(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function p(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(l){return function(u){if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,l])}}}function h(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function v(e,t,n){if(n||2==arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function m(e){return"function"==typeof e}function g(e){var t=e(function(e){Error.call(e),e.stack=Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var w=g(function(e){return function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(e,t){return t+1+") "+e.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function _(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var S=function(){var e;function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,t,n,r,o;if(!this.closed){this.closed=!0;var i=this._parentage;if(i){if(this._parentage=null,Array.isArray(i))try{for(var a=h(i),u=a.next();!u.done;u=a.next())u.value.remove(this)}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else i.remove(this)}var l=this.initialTeardown;if(m(l))try{l()}catch(e){o=e instanceof w?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var s=h(c),f=s.next();!f.done;f=s.next()){var d=f.value;try{k(d)}catch(e){o=o??[],e instanceof w?o=v(v([],y(o)),y(e.errors)):o.push(e)}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}if(o)throw new w(o)}},t.prototype.add=function(e){var n;if(e&&e!==this){if(this.closed)k(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}},t.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},t.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},t.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&_(t,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&_(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}(),E=S.EMPTY;function T(e){return e instanceof S||e&&"closed"in e&&m(e.remove)&&m(e.add)&&m(e.unsubscribe)}function k(e){m(e)?e():e.unsubscribe()}var x={Promise:void 0},C={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,v([e,t],y(n)))},clearTimeout:function(e){var t=C.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function O(e){C.setTimeout(function(){throw e})}function P(){}var j=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,T(t)&&t.add(n)):n.destination=A,n}return d(t,e),t.create=function(e,t,n){return new I(e,t,n)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(S),R=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){O(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){O(e)}else O(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){O(e)}},e}(),I=function(e){function t(t,n,r){var o,i=e.call(this)||this;return o=m(t)||!t?{next:t??void 0,error:n??void 0,complete:r??void 0}:t,i.destination=new R(o),i}return d(t,e),t}(j),A={closed:!0,next:P,error:function(e){throw e},complete:P},L="function"==typeof Symbol&&Symbol.observable||"@@observable";function M(e){return e}var N=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,o,i,a=(r=e)&&r instanceof j||r&&m(r.next)&&m(r.error)&&m(r.complete)&&T(r)?e:new I(e,t,n);return o=this.operator,i=this.source,a.add(o?o.call(a,i):i?this._subscribe(a):this._trySubscribe(a)),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=U(t))(function(t,r){var o=new I({next:function(t){try{e(t)}catch(e){r(e),o.unsubscribe()}},error:r,complete:t});n.subscribe(o)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[L]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===e.length?M:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)})(this)},e.prototype.toPromise=function(e){var t=this;return new(e=U(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}();function U(e){var t;return null!==(t=e??x.Promise)&&void 0!==t?t:Promise}function D(e){return function(t){if(m(null==t?void 0:t.lift))return t.lift(function(t){try{return e(t,this)}catch(e){this.error(e)}});throw TypeError("Unable to lift unknown Observable type")}}function Q(e,t,n,r,o){return new F(e,t,n,r,o)}var F=function(e){function t(t,n,r,o,i,a){var u=e.call(this,t)||this;return u.onFinalize=i,u.shouldUnsubscribe=a,u._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,u._error=o?function(e){try{o(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,u._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,u}return d(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),n||null===(t=this.onFinalize)||void 0===t||t.call(this)}},t}(j),z=g(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),V=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return d(t,e),t.prototype.lift=function(e){var t=new W(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new z},t.prototype.next=function(e){var t=this;(function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var o=h(t.currentObservers),i=o.next();!i.done;i=o.next())i.value.next(e)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}})()},t.prototype.error=function(e){var t=this;(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})()},t.prototype.complete=function(){var e=this;(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})()},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this.hasError,r=this.isStopped,o=this.observers;return n||r?E:(this.currentObservers=null,o.push(e),new S(function(){t.currentObservers=null,_(o,e)}))},t.prototype._checkFinalizedStatuses=function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()},t.prototype.asObservable=function(){var e=new N;return e.source=this,e},t.create=function(e,t){return new W(e,t)},t}(N),W=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return d(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:E},t}(V),$=(function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}d(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n.closed||t.next(this._value),n},t.prototype.getValue=function(){var e=this.hasError,t=this.thrownError,n=this._value;if(e)throw t;return this._throwIfClosed(),n},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)}}(V),function(e){function t(t,n){return e.call(this)||this}return d(t,e),t.prototype.schedule=function(e,t){return this},t}(S)),J={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,v([e,t],y(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},B=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return d(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n,r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),J.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&J.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,_(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}($),G=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}();function Y(e){var t;return(t=e[e.length-1])&&m(t.schedule)?e.pop():void 0}new(function(e){function t(t,n){void 0===n&&(n=G.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return d(t,e),t.prototype.flush=function(e){var t,n=this.actions;if(this._active){n.push(e);return}this._active=!0;do if(t=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,t){for(;e=n.shift();)e.unsubscribe();throw t}},t}(G))(B),new N(function(e){return e.complete()});var q=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function H(e){return m(null==e?void 0:e.then)}function X(e){return Symbol.asyncIterator&&m(null==e?void 0:e[Symbol.asyncIterator])}function K(e){return TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Z="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function ee(e){return m(null==e?void 0:e[Z])}function et(e){return function(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(e,t){o[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||u(e,t)})},t&&(r[e]=t(r[e])))}function u(e,t){try{var n;(n=o[e](t)).value instanceof b?Promise.resolve(n.value.v).then(l,c):s(i[0][2],n)}catch(e){s(i[0][3],e)}}function l(e){u("next",e)}function c(e){u("throw",e)}function s(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}(this,arguments,function(){var t,n,r;return p(this,function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,b(t.read())];case 3:return r=(n=o.sent()).value,n.done?[4,b(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,b(r)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function en(e){return m(null==e?void 0:e.getReader)}function er(e){if(e instanceof N)return e;if(null!=e){if(m(e[L]))return new N(function(t){var n=e[L]();if(m(n.subscribe))return n.subscribe(t);throw TypeError("Provided object does not correctly implement Symbol.observable")});if(q(e))return new N(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()});if(H(e))return new N(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,O)});if(X(e))return eo(e);if(ee(e))return new N(function(t){var n,r;try{for(var o=h(e),i=o.next();!i.done;i=o.next()){var a=i.value;if(t.next(a),t.closed)return}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}t.complete()});if(en(e))return eo(et(e))}throw K(e)}function eo(e){return new N(function(t){(function(e,t){var n,r,o,i,a,u,l,c;return a=this,u=void 0,l=void 0,c=function(){var a;return p(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=h(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,o){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,o,(t=e[n](t)).done,t.value)})}}}(e),u.label=1;case 1:return[4,n.next()];case 2:if((r=u.sent()).done)return[3,4];if(a=r.value,t.next(a),t.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o={error:u.sent()},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})},new(l||(l=Promise))(function(e,t){function n(e){try{o(c.next(e))}catch(e){t(e)}}function r(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):((o=t.value)instanceof l?o:new l(function(e){e(o)})).then(n,r)}o((c=c.apply(a,u||[])).next())})})(e,t).catch(function(e){return t.error(e)})})}function ei(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=!1);var i=t.schedule(function(){n(),o?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(i),!o)return i}function ea(e,t){return void 0===t&&(t=0),D(function(n,r){n.subscribe(Q(r,function(n){return ei(r,e,function(){return r.next(n)},t)},function(){return ei(r,e,function(){return r.complete()},t)},function(n){return ei(r,e,function(){return r.error(n)},t)}))})}function eu(e,t){return void 0===t&&(t=0),D(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function el(e,t){if(!e)throw Error("Iterable cannot be null");return new N(function(n){ei(n,t,function(){var r=e[Symbol.asyncIterator]();ei(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function ec(e,t){return D(function(n,r){var o=0;n.subscribe(Q(r,function(n){r.next(e.call(t,n,o++))}))})}function es(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(void 0===(e=1)&&(e=1/0),function e(t,n,r){return void 0===r&&(r=1/0),m(n)?e(function(e,r){return ec(function(t,o){return n(e,t,r,o)})(er(t(e,r)))},r):("number"==typeof n&&(r=n),D(function(e,n){var o,i,a,u,l,c,s;return o=r,i=[],a=0,u=0,l=!1,c=function(){!l||i.length||a||n.complete()},s=function(e){a++;var r=!1;er(t(e,u++)).subscribe(Q(n,function(e){n.next(e)},function(){r=!0},void 0,function(){if(r)try{for(a--;i.length&&a<o;)!function(){var e=i.shift();s(e)}();c()}catch(e){n.error(e)}}))},e.subscribe(Q(n,function(e){return a<o?s(e):i.push(e)},function(){l=!0,c()})),function(){}}))}(M,e))((t=Y(n))?function(e,t){if(null!=e){if(m(e[L]))return er(e).pipe(eu(t),ea(t));if(q(e))return new N(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})});if(H(e))return er(e).pipe(eu(t),ea(t));if(X(e))return el(e,t);if(ee(e))return new N(function(n){var r;return ei(n,t,function(){r=e[Z](),ei(n,t,function(){var e,t,o;try{t=(e=r.next()).value,o=e.done}catch(e){n.error(e);return}o?n.complete():n.next(t)},0,!0)}),function(){return m(null==r?void 0:r.return)&&r.return()}});if(en(e))return el(et(e),t)}throw K(e)}(n,t):er(n))}function ef(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Y(e);return D(function(t,r){(n?es(e,t,n):es(e,t)).subscribe(r)})}function ed(e){var t;return!(typeof e>"u")&&(!!e&&e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("track")&&"u">typeof(null==(t=e.publication)?void 0:t.track)||!!e&&e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("publication")&&"u">typeof e.publication)}function ep(e){if("string"==typeof e||"number"==typeof e)return`${e}`;if(e&&e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&typeof e.publication>"u")return`${e.participant.identity}_${e.source}_placeholder`;if(ed(e))return`${e.participant.identity}_${e.publication.source}_${e.publication.trackSid}`;throw Error(`Can't generate a id for the given track reference: ${e}`)}g(function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var eh=[i.TQ.ConnectionStateChanged,i.TQ.RoomMetadataChanged,i.TQ.ActiveSpeakersChanged,i.TQ.ConnectionQualityChanged,i.TQ.ParticipantConnected,i.TQ.ParticipantDisconnected,i.TQ.ParticipantPermissionsChanged,i.TQ.ParticipantMetadataChanged,i.TQ.ParticipantNameChanged,i.TQ.ParticipantAttributesChanged,i.TQ.TrackMuted,i.TQ.TrackUnmuted,i.TQ.TrackPublished,i.TQ.TrackUnpublished,i.TQ.TrackStreamStateChanged,i.TQ.TrackSubscriptionFailed,i.TQ.TrackSubscriptionPermissionChanged,i.TQ.TrackSubscriptionStatusChanged,i.TQ.LocalTrackPublished,i.TQ.LocalTrackUnpublished],ey=([...(i.dd.TrackPublished,i.dd.TrackUnpublished,i.dd.TrackMuted,i.dd.TrackUnmuted,i.dd.TrackStreamStateChanged,i.dd.TrackSubscribed,i.dd.TrackUnsubscribed,i.dd.TrackSubscriptionPermissionChanged,i.dd.TrackSubscriptionFailed,i.dd.LocalTrackPublished,i.dd.LocalTrackUnpublished,[i.dd.ConnectionQualityChanged,i.dd.IsSpeakingChanged,i.dd.ParticipantMetadataChanged,i.dd.ParticipantPermissionsChanged,i.dd.TrackMuted,i.dd.TrackUnmuted,i.dd.TrackPublished,i.dd.TrackUnpublished,i.dd.TrackStreamStateChanged,i.dd.TrackSubscriptionFailed,i.dd.TrackSubscriptionPermissionChanged,i.dd.TrackSubscriptionStatusChanged]),i.dd.LocalTrackPublished,i.dd.LocalTrackUnpublished],s.getLogger("lk-components-js"));function ev(e){return"object"==typeof e}function eb(e){return Array.isArray(e)&&e.filter(ev).length>0}function em(e){let t=eg(e),n=(function(e,...t){return new N(n=>{let r=()=>{n.next(e)};return t.forEach(t=>{e.on(t,r)}),()=>{t.forEach(t=>{e.off(t,r)})}}).pipe(ef(e))})(e.participant,i.dd.TrackMuted,i.dd.TrackUnmuted,i.dd.ParticipantPermissionsChanged,i.dd.TrackPublished,i.dd.TrackUnpublished,i.dd.LocalTrackPublished,i.dd.LocalTrackUnpublished,i.dd.MediaDevicesError,i.dd.TrackSubscriptionStatusChanged).pipe(ec(e=>{let{isMicrophoneEnabled:t,isCameraEnabled:n,isScreenShareEnabled:r}=e,o=e.getTrackPublication(i.fQ.Source.Microphone),a=e.getTrackPublication(i.fQ.Source.Camera);return{isCameraEnabled:n,isMicrophoneEnabled:t,isScreenShareEnabled:r,cameraTrack:a,microphoneTrack:o,participant:e}})).pipe(ec(()=>eg(e)),ef(t));return{className:`lk-${e.source===i.fQ.Source.Camera||e.source===i.fQ.Source.ScreenShare?"participant-media-video":"participant-media-audio"}`,trackObserver:n}}function eg(e){if(ed(e))return e.publication;{let{source:t,name:n,participant:r}=e;if(t&&n)return r.getTrackPublications().find(e=>e.source===t&&e.trackName===n);if(n)return r.getTrackPublicationByName(n);if(t)return r.getTrackPublication(t);throw Error("At least one of source and name needs to be defined")}}function ew(){return{className:"lk-room-container"}}function e_(e,t,n=!0){let r=[e.localParticipant,...Array.from(e.remoteParticipants.values())],o=[];return r.forEach(e=>{t.forEach(t=>{let r=Array.from(e.trackPublications.values()).filter(e=>e.source===t&&(!n||e.track)).map(t=>({participant:e,publication:t,source:t.source}));o.push(...r)})}),{trackReferences:o,participants:r}}function eS(e,t,n){var r,o;let a=null!=(r=n.additionalRoomEvents)?r:eh,u=null==(o=n.onlySubscribed)||o,l=Array.from(new Set([i.TQ.ParticipantConnected,i.TQ.ParticipantDisconnected,i.TQ.ConnectionStateChanged,i.TQ.LocalTrackPublished,i.TQ.LocalTrackUnpublished,i.TQ.TrackPublished,i.TQ.TrackUnpublished,i.TQ.TrackSubscriptionStatusChanged,...a]).values());return(function(e,...t){return new N(n=>{let r=()=>{n.next(e)};return t.forEach(t=>{e.on(t,r)}),()=>{t.forEach(t=>{e.off(t,r)})}}).pipe(ef(e))})(e,...l).pipe(ec(e=>{let n=e_(e,t,u);return ey.debug(`TrackReference[] was updated. (length ${n.trackReferences.length})`,n),n}),ef(e_(e,t,u)))}ey.setDefaultLevel("WARN"),new TextEncoder,new TextDecoder;var{load:eE,save:eT}=(o="lk-user-choices",{load:()=>(function(e){if(typeof localStorage>"u"){ey.error("Local storage is not available.");return}try{let t=localStorage.getItem(e);if(!t){ey.warn(`Item with key ${e} does not exist in local storage.`);return}return JSON.parse(t)}catch(e){ey.error(`Error getting item from local storage: ${e}`);return}})(o),save:e=>(function(e,t){if(typeof localStorage>"u"){ey.error("Local storage is not available.");return}try{if(t){let n=Object.fromEntries(Object.entries(t).filter(([,e])=>""!==e));localStorage.setItem(e,JSON.stringify(n))}}catch(e){ey.error(`Error setting item to local storage: ${e}`)}})(o,e)});a.createContext(void 0);let ek=a.createContext(void 0);function ex(e){let t=a.useContext(ek),n=e??t;if(!n)throw Error("No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly");return n}a.createContext(void 0);let eC=a.createContext(void 0);function eO(e){let t=a.useContext(eC),n=e??t;if(!n)throw Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}let eP=a.createContext(void 0)},7566:function(e,t,n){"use strict";n.d(t,{L:function(){return f},a:function(){return l}});var r=n(2265),o=n(5938),i=n(3905);function a(...e){let t={...e[0]};for(let n=1;n<e.length;n++){let r=e[n];for(let e in r){let n=t[e],o=r[e];"function"==typeof n&&"function"==typeof o&&"o"===e[0]&&"n"===e[1]&&e.charCodeAt(2)>=65&&90>=e.charCodeAt(2)?t[e]=function(...e){return(...t)=>{for(let n of e)if("function"==typeof n)try{n(...t)}catch(e){console.error(e)}}}(n,o):("className"===e||"UNSAFE_className"===e)&&"string"==typeof n&&"string"==typeof o?t[e]=function(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=function e(t){var n,r,o="";if("string"==typeof t||"number"==typeof t)o+=t;else if("object"==typeof t){if(Array.isArray(t)){var i=t.length;for(n=0;n<i;n++)t[n]&&(r=e(t[n]))&&(o&&(o+=" "),o+=r)}else for(r in t)t[r]&&(o&&(o+=" "),o+=r)}return o}(e))&&(r&&(r+=" "),r+=t);return r}(n,o):t[e]=void 0!==o?o:n}}return t}function u(e){return void 0!==e}function l(...e){return a(...e.filter(u))}function c(e,t){return"processor"===e&&t&&"object"==typeof t&&"name"in t?t.name:"e2ee"===e&&t?"e2ee-enabled":t}n(5566);let s={connect:!0,audio:!1,video:!1},f=r.forwardRef(function(e,t){let{room:n,htmlProps:u}=function(e){let{token:t,serverUrl:n,options:u,room:l,connectOptions:f,connect:d,audio:p,video:h,screen:y,onConnected:v,onDisconnected:b,onError:m,onMediaDeviceFailure:g,onEncryptionError:w,simulateParticipants:_,...S}={...s,...e};u&&l&&o.l.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");let[E,T]=r.useState(),k=r.useRef(d);r.useEffect(()=>{T(l??new i.du(u))},[l,JSON.stringify(u,c)]);let x=r.useMemo(()=>{let{className:e}=(0,o.s)();return a(S,{className:e})},[S]);return r.useEffect(()=>{if(!E)return;let e=()=>{let e=E.localParticipant;o.l.debug("trying to publish local tracks"),Promise.all([e.setMicrophoneEnabled(!!p,"boolean"!=typeof p?p:void 0),e.setCameraEnabled(!!h,"boolean"!=typeof h?h:void 0),e.setScreenShareEnabled(!!y,"boolean"!=typeof y?y:void 0)]).catch(e=>{o.l.warn(e),null==m||m(e)})},t=e=>{let t=i.CB.getFailure(e);null==g||g(t)},n=e=>{null==w||w(e)},r=e=>{null==b||b(e)},a=()=>{null==v||v()};return E.on(i.TQ.SignalConnected,e).on(i.TQ.MediaDevicesError,t).on(i.TQ.EncryptionError,n).on(i.TQ.Disconnected,r).on(i.TQ.Connected,a),()=>{E.off(i.TQ.SignalConnected,e).off(i.TQ.MediaDevicesError,t).off(i.TQ.EncryptionError,n).off(i.TQ.Disconnected,r).off(i.TQ.Connected,a)}},[E,p,h,y,m,w,g,v,b]),r.useEffect(()=>{if(E){if(_){E.simulateParticipants({participants:{count:_},publish:{audio:!0,useRealTracks:!0}});return}if(d){if(k.current=!0,o.l.debug("connecting"),!t){o.l.debug("no token yet");return}if(!n){o.l.warn("no livekit url provided"),null==m||m(Error("no livekit url provided"));return}E.connect(n,t,f).catch(e=>{o.l.warn(e),!0===k.current&&(null==m||m(e))})}else o.l.debug("disconnecting because connect is false"),k.current=!1,E.disconnect()}},[d,t,JSON.stringify(f),E,m,n,_]),r.useEffect(()=>{if(E)return()=>{o.l.info("disconnecting on onmount"),E.disconnect()}},[E]),{room:E,htmlProps:x}}(e);return r.createElement("div",{ref:t,...u},n&&r.createElement(o.R.Provider,{value:n},r.createElement(o.L.Provider,{value:e.featureFlags},e.children)))})},8050:function(e,t,n){"use strict";n.d(t,{RJ:function(){return em}});var r,o=n(2265),i=n(6272);let a=()=>{},u=a(),l=Object,c=e=>e===u,s=e=>"function"==typeof e,f=(e,t)=>({...e,...t}),d=e=>s(e.then),p=new WeakMap,h=0,y=e=>{let t,n;let r=typeof e,o=e&&e.constructor,i=o==Date;if(l(e)!==e||i||o==RegExp)t=i?e.toJSON():"symbol"==r?e.toString():"string"==r?JSON.stringify(e):""+e;else{if(t=p.get(e))return t;if(t=++h+"~",p.set(e,t),o==Array){for(n=0,t="@";n<e.length;n++)t+=y(e[n])+",";p.set(e,t)}if(o==l){t="#";let r=l.keys(e).sort();for(;!c(n=r.pop());)c(e[n])||(t+=n+":"+y(e[n])+",");p.set(e,t)}}return t},v=new WeakMap,b={},m={},g="undefined",w=typeof window!=g,_=typeof document!=g,S=()=>w&&typeof window.requestAnimationFrame!=g,E=(e,t)=>{let n=v.get(e);return[()=>!c(t)&&e.get(t)||b,r=>{if(!c(t)){let o=e.get(t);t in m||(m[t]=o),n[5](t,f(o,r),o||b)}},n[6],()=>!c(t)&&t in m?m[t]:!c(t)&&e.get(t)||b]},T=!0,[k,x]=w&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[a,a],C={initFocus:e=>(_&&document.addEventListener("visibilitychange",e),k("focus",e),()=>{_&&document.removeEventListener("visibilitychange",e),x("focus",e)}),initReconnect:e=>{let t=()=>{T=!0,e()},n=()=>{T=!1};return k("online",t),k("offline",n),()=>{x("online",t),x("offline",n)}}},O=!o.useId,P=!w||"Deno"in window,j=e=>S()?window.requestAnimationFrame(e):setTimeout(e,1),R=P?o.useEffect:o.useLayoutEffect,I="undefined"!=typeof navigator&&navigator.connection,A=!P&&I&&(["slow-2g","2g"].includes(I.effectiveType)||I.saveData),L=e=>{if(s(e))try{e=e()}catch(t){e=""}let t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?y(e):"",t]},M=0,N=()=>++M;var U={ERROR_REVALIDATE_EVENT:3,FOCUS_EVENT:0,MUTATE_EVENT:2,RECONNECT_EVENT:1};async function D(...e){let[t,n,r,o]=e,i=f({populateCache:!0,throwOnError:!0},"boolean"==typeof o?{revalidate:o}:o||{}),a=i.populateCache,l=i.rollbackOnError,p=i.optimisticData,h=!1!==i.revalidate,y=e=>"function"==typeof l?l(e):!1!==l,b=i.throwOnError;if(s(n)){let e=[],r=t.keys();for(let o of r)!/^\$(inf|sub)\$/.test(o)&&n(t.get(o)._k)&&e.push(o);return Promise.all(e.map(m))}return m(n);async function m(n){let o;let[i]=L(n);if(!i)return;let[l,f]=E(t,i),[m,g,w,_]=v.get(t),S=m[i],T=()=>h&&(delete w[i],delete _[i],S&&S[0])?S[0](2).then(()=>l().data):l().data;if(e.length<3)return T();let k=r,x=N();g[i]=[x,0];let C=!c(p),O=l(),P=O.data,j=O._c,R=c(j)?P:j;if(C&&f({data:p=s(p)?p(R,P):p,_c:R}),s(k))try{k=k(R)}catch(e){o=e}if(k&&d(k)){if(k=await k.catch(e=>{o=e}),x!==g[i][0]){if(o)throw o;return k}o&&C&&y(o)&&(a=!0,f({data:k=R,_c:u}))}a&&!o&&(s(a)&&(k=a(k,R)),f({data:k,error:u,_c:u})),g[i][1]=N();let I=await T();if(f({_c:u}),o){if(b)throw o;return}return a?I:k}}let Q=(e,t)=>{for(let n in e)e[n][0]&&e[n][0](t)},F=(e,t)=>{if(!v.has(e)){let n=f(C,t),r={},o=D.bind(u,e),i=a,l={},c=(e,t)=>{let n=l[e]||[];return l[e]=n,n.push(t),()=>n.splice(n.indexOf(t),1)},s=(t,n,r)=>{e.set(t,n);let o=l[t];if(o)for(let e of o)e(n,r)},d=()=>{if(!v.has(e)&&(v.set(e,[r,{},{},{},o,s,c]),!P)){let t=n.initFocus(setTimeout.bind(u,Q.bind(u,r,0))),o=n.initReconnect(setTimeout.bind(u,Q.bind(u,r,1)));i=()=>{t&&t(),o&&o(),v.delete(e)}}};return d(),[e,o,d,i]}return[e,v.get(e)[4]]},[z,V]=F(new Map),W=f({onLoadingSlow:a,onSuccess:a,onError:a,onErrorRetry:(e,t,n,r,o)=>{let i=n.errorRetryCount,a=o.retryCount,u=~~((Math.random()+.5)*(1<<(a<8?a:8)))*n.errorRetryInterval;(c(i)||!(a>i))&&setTimeout(r,u,o)},onDiscarded:a,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:A?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:A?5e3:3e3,compare:(e,t)=>y(e)==y(t),isPaused:()=>!1,cache:z,mutate:V,fallback:{}},{isOnline:()=>T,isVisible:()=>{let e=_&&document.visibilityState;return c(e)||"hidden"!==e}}),$=(e,t)=>{let n=f(e,t);if(t){let{use:r,fallback:o}=e,{use:i,fallback:a}=t;r&&i&&(n.use=r.concat(i)),o&&a&&(n.fallback=f(o,a))}return n},J=(0,o.createContext)({}),B=w&&window.__SWR_DEVTOOLS_USE__,G=B?window.__SWR_DEVTOOLS_USE__:[],Y=e=>s(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}],q=()=>f(W,(0,o.useContext)(J)),H=G.concat(e=>(t,n,r)=>{let o=n&&((...e)=>{let[r]=L(t),[,,,o]=v.get(z),i=o[r];return c(i)?n(...e):(delete o[r],i)});return e(t,o,r)}),X=(e,t,n)=>{let r=t[e]||(t[e]=[]);return r.push(n),()=>{let e=r.indexOf(n);e>=0&&(r[e]=r[r.length-1],r.pop())}};B&&(window.__SWR_DEVTOOLS_REACT__=o);let K=o.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;if("rejected"===e.status)throw e.reason;throw e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e}),Z={dedupe:!0};l.defineProperty(e=>{let{value:t}=e,n=(0,o.useContext)(J),r=s(t),i=(0,o.useMemo)(()=>r?t(n):t,[r,n,t]),a=(0,o.useMemo)(()=>r?i:$(n,i),[r,n,i]),l=i&&i.provider,c=(0,o.useRef)(u);l&&!c.current&&(c.current=F(l(a.cache||z),i));let d=c.current;return d&&(a.cache=d[0],a.mutate=d[1]),R(()=>{if(d)return d[2]&&d[2](),d[3]},[]),(0,o.createElement)(J.Provider,f(e,{value:a}))},"defaultValue",{value:W});let ee=(r=(e,t,n)=>{let{cache:r,compare:a,suspense:l,fallbackData:d,revalidateOnMount:p,revalidateIfStale:h,refreshInterval:y,refreshWhenHidden:b,refreshWhenOffline:m,keepPreviousData:g}=n,[w,_,S,T]=v.get(r),[k,x]=L(e),C=(0,o.useRef)(!1),I=(0,o.useRef)(!1),A=(0,o.useRef)(k),M=(0,o.useRef)(t),Q=(0,o.useRef)(n),F=()=>Q.current,z=()=>F().isVisible()&&F().isOnline(),[V,W,$,J]=E(r,k),B=(0,o.useRef)({}).current,G=c(d)?n.fallback[k]:d,Y=(e,t)=>{for(let n in B)if("data"===n){if(!a(e[n],t[n])&&(!c(e[n])||!a(ea,t[n])))return!1}else if(t[n]!==e[n])return!1;return!0},q=(0,o.useMemo)(()=>{let e=!!k&&!!t&&(c(p)?!F().isPaused()&&!l&&(!!c(h)||h):p),n=t=>{let n=f(t);return(delete n._k,e)?{isValidating:!0,isLoading:!0,...n}:n},r=V(),o=J(),i=n(r),a=r===o?i:n(o),u=i;return[()=>{let e=n(V()),t=Y(e,u);return t?(u.data=e.data,u.isLoading=e.isLoading,u.isValidating=e.isValidating,u.error=e.error,u):(u=e,e)},()=>a]},[r,k]),H=(0,i.useSyncExternalStore)((0,o.useCallback)(e=>$(k,(t,n)=>{Y(n,t)||e()}),[r,k]),q[0],q[1]),ee=!C.current,et=w[k]&&w[k].length>0,en=H.data,er=c(en)?G:en,eo=H.error,ei=(0,o.useRef)(er),ea=g?c(en)?ei.current:en:er,eu=(!et||!!c(eo))&&(ee&&!c(p)?p:!F().isPaused()&&(l?!c(er)&&h:c(er)||h)),el=!!(k&&t&&ee&&eu),ec=c(H.isValidating)?el:H.isValidating,es=c(H.isLoading)?el:H.isLoading,ef=(0,o.useCallback)(async e=>{let t,r;let o=M.current;if(!k||!o||I.current||F().isPaused())return!1;let i=!0,l=e||{},f=!S[k]||!l.dedupe,d=()=>O?!I.current&&k===A.current&&C.current:k===A.current,p={isValidating:!1,isLoading:!1},h=()=>{W(p)},y=()=>{let e=S[k];e&&e[1]===r&&delete S[k]},v={isValidating:!0};c(V().data)&&(v.isLoading=!0);try{if(f&&(W(v),n.loadingTimeout&&c(V().data)&&setTimeout(()=>{i&&d()&&F().onLoadingSlow(k,n)},n.loadingTimeout),S[k]=[o(x),N()]),[t,r]=S[k],t=await t,f&&setTimeout(y,n.dedupingInterval),!S[k]||S[k][1]!==r)return f&&d()&&F().onDiscarded(k),!1;p.error=u;let e=_[k];if(!c(e)&&(r<=e[0]||r<=e[1]||0===e[1]))return h(),f&&d()&&F().onDiscarded(k),!1;let l=V().data;p.data=a(l,t)?l:t,f&&d()&&F().onSuccess(t,k,n)}catch(n){y();let e=F(),{shouldRetryOnError:t}=e;!e.isPaused()&&(p.error=n,f&&d()&&(e.onError(n,k,e),(!0===t||s(t)&&t(n))&&z()&&e.onErrorRetry(n,k,e,e=>{let t=w[k];t&&t[0]&&t[0](U.ERROR_REVALIDATE_EVENT,e)},{retryCount:(l.retryCount||0)+1,dedupe:!0})))}return i=!1,h(),!0},[k,r]),ed=(0,o.useCallback)((...e)=>D(r,A.current,...e),[]);if(R(()=>{M.current=t,Q.current=n,c(en)||(ei.current=en)}),R(()=>{if(!k)return;let e=ef.bind(u,Z),t=0,n=X(k,w,(n,r={})=>{if(n==U.FOCUS_EVENT){let n=Date.now();F().revalidateOnFocus&&n>t&&z()&&(t=n+F().focusThrottleInterval,e())}else if(n==U.RECONNECT_EVENT)F().revalidateOnReconnect&&z()&&e();else if(n==U.MUTATE_EVENT)return ef();else if(n==U.ERROR_REVALIDATE_EVENT)return ef(r)});return I.current=!1,A.current=k,C.current=!0,W({_k:x}),eu&&(c(er)||P?e():j(e)),()=>{I.current=!0,n()}},[k]),R(()=>{let e;function t(){let t=s(y)?y(V().data):y;t&&-1!==e&&(e=setTimeout(n,t))}function n(){!V().error&&(b||F().isVisible())&&(m||F().isOnline())?ef(Z).then(t):t()}return t(),()=>{e&&(clearTimeout(e),e=-1)}},[y,b,m,k]),(0,o.useDebugValue)(ea),l&&c(er)&&k){if(!O&&P)throw Error("Fallback data is required when using suspense in SSR.");M.current=t,Q.current=n,I.current=!1;let e=T[k];if(!c(e)){let t=ed(e);K(t)}if(c(eo)){let e=ef(Z);c(ea)||(e.status="fulfilled",e.value=!0),K(e)}else throw eo}return{mutate:ed,get data(){return B.data=!0,ea},get error(){return B.error=!0,eo},get isValidating(){return B.isValidating=!0,ec},get isLoading(){return B.isLoading=!0,es}}},function(...e){let t=q(),[n,o,i]=Y(e),a=$(t,i),u=r,{use:l}=a,c=(l||[]).concat(H);for(let e=c.length;e--;)u=c[e](u);return u(n,o||a.fetcher||null,a)});var et={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},en={code:"1",name:"function_call",parse:e=>{if(null==e||"object"!=typeof e||!("function_call"in e)||"object"!=typeof e.function_call||null==e.function_call||!("name"in e.function_call)||!("arguments"in e.function_call)||"string"!=typeof e.function_call.name||"string"!=typeof e.function_call.arguments)throw Error('"function_call" parts expect an object with a "function_call" property.');return{type:"function_call",value:e}}},er={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw Error('"data" parts expect an array value.');return{type:"data",value:e}}},eo={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},ei={code:"4",name:"assistant_message",parse:e=>{if(null==e||"object"!=typeof e||!("id"in e)||!("role"in e)||!("content"in e)||"string"!=typeof e.id||"string"!=typeof e.role||"assistant"!==e.role||!Array.isArray(e.content)||!e.content.every(e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value))throw Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},ea={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},eu={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},el={code:"7",name:"tool_calls",parse:e=>{if(null==e||"object"!=typeof e||!("tool_calls"in e)||"object"!=typeof e.tool_calls||null==e.tool_calls||!Array.isArray(e.tool_calls)||e.tool_calls.some(e=>{null!=e&&"object"==typeof e&&"id"in e&&"string"==typeof e.id&&"type"in e&&"string"==typeof e.type&&"function"in e&&null!=e.function&&"object"==typeof e.function&&"arguments"in e.function&&"string"==typeof e.function.name&&e.function.arguments}))throw Error('"tool_calls" parts expect an object with a ToolCallPayload.');return{type:"tool_calls",value:e}}},ec={[et.code]:et,[en.code]:en,[er.code]:er,[eo.code]:eo,[ei.code]:ei,[ea.code]:ea,[eu.code]:eu,[el.code]:el};et.name,et.code,en.name,en.code,er.name,er.code,eo.name,eo.code,ei.name,ei.code,ea.name,ea.code,eu.name,eu.code,el.name,el.code;var es=[et,en,er,eo,ei,ea,eu,el].map(e=>e.code),ef=e=>{let t=e.indexOf(":");if(-1===t)throw Error("Failed to parse stream string. No separator found.");let n=e.slice(0,t);if(!es.includes(n))throw Error(`Failed to parse stream string. Invalid code ${n}.`);let r=e.slice(t+1),o=JSON.parse(r);return ec[n].parse(o)};async function*ed(e,{isAborted:t}={}){let n=new TextDecoder,r=[],o=0;for(;;){let{value:i}=await e.read();if(i&&(r.push(i),o+=i.length,10!==i[i.length-1]))continue;if(0===r.length)break;let a=function(e,t){let n=new Uint8Array(t),r=0;for(let t of e)n.set(t,r),r+=t.length;return e.length=0,n}(r,o);o=0;let u=n.decode(a,{stream:!0}).split("\n").filter(e=>""!==e).map(ef);for(let e of u)yield e;if(null==t?void 0:t()){e.cancel();break}}}var ep=((e,t=21)=>(n=t)=>{let r="",o=n;for(;o--;)r+=e[Math.random()*e.length|0];return r})("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",7);async function eh({reader:e,abortControllerRef:t,update:n,onFinish:r,generateId:o=ep,getCurrentDate:i=()=>new Date}){let a=i(),u={data:[]};for await(let{type:r,value:i}of ed(e,{isAborted:()=>(null==t?void 0:t.current)===null})){"text"===r&&(u.text?u.text={...u.text,content:(u.text.content||"")+i}:u.text={id:o(),role:"assistant",content:i,createdAt:a});let e=null;"function_call"===r&&(u.function_call={id:o(),role:"assistant",content:"",function_call:i.function_call,name:i.function_call.name,createdAt:a},e=u.function_call);let t=null;"tool_calls"===r&&(u.tool_calls={id:o(),role:"assistant",content:"",tool_calls:i.tool_calls,createdAt:a},t=u.tool_calls),"data"===r&&u.data.push(...i);let l=u.text,c=[e,t,l].filter(Boolean);n(c,[...u.data])}return null==r||r(u),{messages:[u.text,u.function_call,u.tool_calls].filter(Boolean),data:u.data}}async function ey({api:e,messages:t,body:n,credentials:r,headers:o,abortController:i,appendMessage:a,restoreMessagesOnFailure:u,onResponse:l,onUpdate:c,onFinish:s,generateId:f}){var d;let p=await fetch(e,{method:"POST",body:JSON.stringify({messages:t,...n}),headers:{"Content-Type":"application/json",...o},signal:null==(d=null==i?void 0:i())?void 0:d.signal,credentials:r}).catch(e=>{throw u(),e});if(l)try{await l(p)}catch(e){throw e}if(!p.ok)throw u(),Error(await p.text()||"Failed to fetch the chat response.");if(!p.body)throw Error("The response body is empty.");let h=p.body.getReader(),y="true"===p.headers.get("X-Experimental-Stream-Data");if(y)return await eh({reader:h,abortControllerRef:null!=i?{current:i()}:void 0,update:c,onFinish(e){s&&null!=e.text&&s(e.text)},generateId:f});{let e=new Date,t=function(e){let t=new TextDecoder;return e?function(e){let n=t.decode(e,{stream:!0}).split("\n").filter(e=>""!==e);return n.map(ef).filter(Boolean)}:function(e){return e?t.decode(e,{stream:!0}):""}}(!1),n="",r=f(),o={id:r,createdAt:e,content:"",role:"assistant"};for(;;){let{done:e,value:r}=await h.read();if(e)break;if((n+=t(r)).startsWith('{"function_call":')?o.function_call=n:n.startsWith('{"tool_calls":')?o.tool_calls=n:o.content=n,a({...o}),(null==i?void 0:i())===null){h.cancel();break}}if(n.startsWith('{"function_call":')){let e=JSON.parse(n).function_call;o.function_call=e,a({...o})}if(n.startsWith('{"tool_calls":')){let e=JSON.parse(n).tool_calls;o.tool_calls=e,a({...o})}return s&&s(o),o}}async function ev({getStreamedResponse:e,experimental_onFunctionCall:t,experimental_onToolCall:n,updateChatRequest:r,getCurrentMessages:o}){for(;;){let i=await e();if("messages"in i){let e=!1;for(let a of i.messages)if(void 0!==a.function_call&&"string"!=typeof a.function_call||void 0!==a.tool_calls&&"string"!=typeof a.tool_calls){if(e=!0,t){let n=a.function_call;if("object"!=typeof n){console.warn("experimental_onFunctionCall should not be defined when using tools");continue}let i=await t(o(),n);if(void 0===i){e=!1;break}r(i)}if(n){let t=a.tool_calls;if(!Array.isArray(t)||t.some(e=>"object"!=typeof e)){console.warn("experimental_onToolCall should not be defined when using tools");continue}let i=await n(o(),t);if(void 0===i){e=!1;break}r(i)}}if(!e)break}else{let e=function(e){for(let t of e.messages){if(void 0!==t.tool_calls)for(let e of t.tool_calls)"object"==typeof e&&e.function.arguments&&"string"!=typeof e.function.arguments&&(e.function.arguments=JSON.stringify(e.function.arguments));void 0!==t.function_call&&"object"==typeof t.function_call&&t.function_call.arguments&&"string"!=typeof t.function_call.arguments&&(t.function_call.arguments=JSON.stringify(t.function_call.arguments))}};if((void 0===i.function_call||"string"==typeof i.function_call)&&(void 0===i.tool_calls||"string"==typeof i.tool_calls))break;if(t){let n=i.function_call;if("object"!=typeof n){console.warn("experimental_onFunctionCall should not be defined when using tools");continue}let a=await t(o(),n);if(void 0===a)break;e(a),r(a)}if(n){let t=i.tool_calls;if("object"!=typeof t){console.warn("experimental_onToolCall should not be defined when using functions");continue}let a=await n(o(),t);if(void 0===a)break;e(a),r(a)}}}}var eb=async(e,t,n,r,o,i,a,u,l,c,s,f)=>{var d,p;let h=a.current;n(t.messages,!1);let y=f?t.messages:t.messages.map(({role:e,content:t,name:n,function_call:r,tool_calls:o,tool_call_id:i})=>({role:e,content:t,tool_call_id:i,...void 0!==n&&{name:n},...void 0!==r&&{function_call:r},...void 0!==o&&{tool_calls:o}}));if("string"!=typeof e){let r=l(),o=new Date,i={id:r,createdAt:o,content:"",role:"assistant"};async function v(e){let{content:r,ui:o,next:a}=await e;i.content=r,i.ui=await o,n([...t.messages,{...i}],!1),a&&await v(a)}try{let n=e({messages:y,data:t.data});await v(n)}catch(e){throw n(h,!1),e}return c&&c(i),i}return await ey({api:e,messages:y,body:{data:t.data,...i.current.body,...null==(d=t.options)?void 0:d.body,...void 0!==t.functions&&{functions:t.functions},...void 0!==t.function_call&&{function_call:t.function_call},...void 0!==t.tools&&{tools:t.tools},...void 0!==t.tool_choice&&{tool_choice:t.tool_choice}},credentials:i.current.credentials,headers:{...i.current.headers,...null==(p=t.options)?void 0:p.headers},abortController:()=>u.current,appendMessage(e){n([...t.messages,e],!1)},restoreMessagesOnFailure(){n(h,!1)},onResponse:s,onUpdate(e,i){n([...t.messages,...e],!1),r([...o||[],...i||[]],!1)},onFinish:c,generateId:l})};function em({api:e="/api/chat",id:t,initialMessages:n,initialInput:r="",sendExtraMessageFields:i,experimental_onFunctionCall:a,experimental_onToolCall:u,onResponse:l,onFinish:c,onError:s,credentials:f,headers:d,body:p,generateId:h=ep}={}){let y=(0,o.useId)(),v=null!=t?t:y,b="string"==typeof e?[e,v]:v,[m]=(0,o.useState)([]),{data:g,mutate:w}=ee([b,"messages"],null,{fallbackData:null!=n?n:m}),{data:_=!1,mutate:S}=ee([b,"loading"],null),{data:E,mutate:T}=ee([b,"streamData"],null),{data:k,mutate:x}=ee([b,"error"],null),C=(0,o.useRef)(g||[]);(0,o.useEffect)(()=>{C.current=g||[]},[g]);let O=(0,o.useRef)(null),P=(0,o.useRef)({credentials:f,headers:d,body:p});(0,o.useEffect)(()=>{P.current={credentials:f,headers:d,body:p}},[f,d,p]);let j=(0,o.useCallback)(async t=>{try{S(!0),x(void 0);let n=new AbortController;O.current=n,await ev({getStreamedResponse:()=>eb(e,t,w,T,E,P,C,O,h,c,l,i),experimental_onFunctionCall:a,experimental_onToolCall:u,updateChatRequest:e=>{t=e},getCurrentMessages:()=>C.current}),O.current=null}catch(e){if("AbortError"===e.name)return O.current=null,null;s&&e instanceof Error&&s(e),x(e)}finally{S(!1)}},[w,S,e,P,l,c,s,x,T,E,i,a,u,C,O,h]),R=(0,o.useCallback)(async(e,{options:t,functions:n,function_call:r,tools:o,tool_choice:i,data:a}={})=>{e.id||(e.id=h());let u={messages:C.current.concat(e),options:t,data:a,...void 0!==n&&{functions:n},...void 0!==r&&{function_call:r},...void 0!==o&&{tools:o},...void 0!==i&&{tool_choice:i}};return j(u)},[j,h]),I=(0,o.useCallback)(async({options:e,functions:t,function_call:n,tools:r,tool_choice:o}={})=>{if(0===C.current.length)return null;let i=C.current[C.current.length-1];if("assistant"===i.role){let i={messages:C.current.slice(0,-1),options:e,...void 0!==t&&{functions:t},...void 0!==n&&{function_call:n},...void 0!==r&&{tools:r},...void 0!==o&&{tool_choice:o}};return j(i)}let a={messages:C.current,options:e,...void 0!==t&&{functions:t},...void 0!==n&&{function_call:n},...void 0!==r&&{tools:r},...void 0!==o&&{tool_choice:o}};return j(a)},[j]),A=(0,o.useCallback)(()=>{O.current&&(O.current.abort(),O.current=null)},[]),L=(0,o.useCallback)(e=>{w(e,!1),C.current=e},[w]),[M,N]=(0,o.useState)(r),U=(0,o.useCallback)((e,t={},n)=>{n&&(P.current={...P.current,...n}),e.preventDefault(),M&&(R({content:M,role:"user",createdAt:new Date},t),N(""))},[M,R]);return{messages:g||[],error:k,append:R,reload:I,stop:A,setMessages:L,input:M,setInput:N,handleInputChange:e=>{N(e.target.value)},handleSubmit:U,isLoading:_,data:E}}}}]);