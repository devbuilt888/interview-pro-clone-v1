(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8588:function(e,t,r){Promise.resolve().then(r.bind(r,5687))},5687:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var n=r(7437),s=r(2265),o=r(6691),i=r.n(o),a=r(7566),c=r(3078);r(7957);var l=r(8050),d=r(6375),u=r(2461),h=()=>{let e=(0,s.useRef)(null),t=(0,s.useRef)(null),r=(0,s.useRef)(null),o=(0,s.useRef)(null),i=(0,s.useRef)([]),a=(0,s.useRef)([]),c=(0,s.useRef)(0),l=(0,s.useRef)([]);return(0,s.useEffect)(()=>{if(!e.current)return;let n=e=>{let t=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);if(t>.02){let r=.02/t;e.x*=r,e.y*=r,e.z*=r}},s=e.current,h=new d.CP7({antialias:!0,alpha:!0});h.setSize(s.clientWidth,s.clientHeight),h.setPixelRatio(Math.min(window.devicePixelRatio,2)),s.appendChild(h.domElement),t.current=h;let p=s.clientWidth/s.clientHeight,m=new u.cPb(75,p,.1,1e3);m.position.z=8,o.current=m;let x=new u.xsS;r.current=x;let f=new u.Mig(16777215,.5);x.add(f);let w=new u.Ox3(16777215,1);w.position.set(5,5,5),x.add(w);let g=new u.cek(29439,1.5,20);g.position.set(-5,3,5),x.add(g);let v=new u.cek(8477183,1.5,20);v.position.set(5,-3,5),x.add(v),x.fog=new u.yo9(593177,.03);let y=[new u.DvJ(1,1,1),new u.cJO(.8,0),new u.pQR(.8),new u.H$k(.9)],j=[29439,8477183,3003583,959977,9133302,3900150,165063,2450411,8141549,6514417];for(let e=0;e<15;e++){let t=y[Math.floor(Math.random()*y.length)],r=new u.EJi({color:j[e%j.length],transparent:!0,opacity:.6,metalness:.2,roughness:.25,clearcoat:.5,clearcoatRoughness:.2,wireframe:Math.random()>.9}),n=new u.Kj0(t,r),s=.5+.7*Math.random();n.scale.set(s,s,s),n.position.x=(Math.random()-.5)*16,n.position.y=(Math.random()-.5)*16,n.position.z=(Math.random()-.5)*16;let o=new u.aLr(n.position.clone(),.8*s);l.current.push(o),a.current.push({x:(Math.random()-.5)*.006,y:(Math.random()-.5)*.006,z:(Math.random()-.5)*.006}),x.add(n),i.current.push(n)}let N=e=>{c.current=.001*e,requestAnimationFrame(N),o.current&&(o.current.position.x=10*Math.sin(.02*c.current),o.current.position.z=10*Math.cos(.02*c.current),o.current.lookAt(0,0,0)),i.current.forEach((e,t)=>{let r=a.current[t];e.position.x+=r.x,e.position.y+=r.y,e.position.z+=r.z,l.current[t].center.copy(e.position),Math.abs(e.position.x)>8&&(r.x*=-1),Math.abs(e.position.y)>8&&(r.y*=-1),Math.abs(e.position.z)>8&&(r.z*=-1),e.rotation.x+=.002+1e-4*t,e.rotation.y+=.003+5e-5*t,e.rotation.z+=.0025+1e-4*t;let n=.03*Math.sin(c.current*(.15+.01*t)),s=.5+t%5*.1+n;e.scale.set(s,s,s),l.current[t].radius=.8*s});for(let e=0;e<i.current.length;e++)for(let t=e+1;t<i.current.length;t++){let r=l.current[e],s=l.current[t],o=r.center.distanceTo(s.center),c=r.radius+s.radius;if(o<c){let d=i.current[e],h=i.current[t],p=a.current[e],m=a.current[t],x=new u.Pa4().subVectors(s.center,r.center).normalize(),f=new u.Pa4(m.x-p.x,m.y-p.y,m.z-p.z),w=1.5*f.dot(x);p.x+=x.x*w,p.y+=x.y*w,p.z+=x.z*w,m.x-=x.x*w,m.y-=x.y*w,m.z-=x.z*w,n(p),n(m);let g=(c-o)/2;d.position.x-=x.x*g,d.position.y-=x.y*g,d.position.z-=x.z*g,h.position.x+=x.x*g,h.position.y+=x.y*g,h.position.z+=x.z*g,l.current[e].center.copy(d.position),l.current[t].center.copy(h.position)}}h.render(x,m)},b=()=>{if(!e.current||!o.current||!t.current)return;let r=e.current,n=o.current,s=t.current;n.aspect=r.clientWidth/r.clientHeight,n.updateProjectionMatrix(),s.setSize(r.clientWidth,r.clientHeight),s.setPixelRatio(Math.min(window.devicePixelRatio,2))};return window.addEventListener("resize",b),N(0),()=>{window.removeEventListener("resize",b),e.current&&t.current&&e.current.removeChild(t.current.domElement),i.current=[],a.current=[],l.current=[]}},[]),(0,n.jsx)("div",{ref:e,className:"background-animation"})};let p=e=>{try{let t=new Audio(e);t.play().catch(e=>{console.error("Error playing sound effect:",e)})}catch(e){console.error("Error initializing audio:",e)}},m=()=>{p("/transformers-sound.mp3")},x=()=>{p("/game-end.mp3")},f=e=>{let{text:t}=e,[r,o]=(0,s.useState)(""),i=(0,s.useRef)(null);return(0,s.useEffect)(()=>{o("");let e="",r=0;return i.current=window.setInterval(()=>{r<t.length?(o(e+=t[r]),r++):i.current&&window.clearInterval(i.current)},50),()=>{i.current&&window.clearInterval(i.current)}},[t]),(0,n.jsx)("h2",{className:"typewriter-text",children:r})};var w=e=>{let{initialText:t}=e,[r,o]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),[p,w]=(0,s.useState)(null),[g,v]=(0,s.useState)(null),[y,j]=(0,s.useState)(null),[N,b]=(0,s.useState)(!1),[E,D]=(0,s.useState)(!1),[S,k]=(0,s.useState)([]),[z,R]=(0,s.useState)(!1),[M,P]=(0,s.useState)(!1),{append:C,messages:I}=(0,l.RJ)({api:"/api/openai-gpt",onFinish:e=>{"assistant"===e.role&&(T(e.content).catch(console.error),e.content.includes("Thank you for your time")&&e.content.includes("have a great day")&&P(!0))}}),F=(0,s.useRef)(null),L=(0,s.useRef)([]),A=(0,s.useRef)(null);(0,s.useEffect)(()=>{var e;null===(e=A.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[S]),(0,s.useEffect)(()=>{r&&p&&g&&y||m()},[r,p,g,y]),(0,s.useEffect)(()=>{M&&x()},[M]);let T=async e=>{try{let t=new SpeechSynthesisUtterance(e);return t.rate=1,t.pitch=1,t.volume=1,new Promise((r,n)=>{t.onend=()=>{console.log("Finished speaking chunk"),console.log("Text-to-speech completed successfully"),r()},t.onerror=e=>{console.error("Error in text-to-speech:",e),n(e)},console.log("Starting to speak:",e),window.speechSynthesis.speak(t)})}catch(e){console.error("Error in text-to-speech:",e)}},O=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";try{if("system"===t){k(r=>[...r,{role:t,content:e}]),await T(e);return}await C({content:e,role:"user"})}catch(e){console.error("Error in sendMessageToOpenAI:",e),u("Failed to get AI response")}};return((0,s.useEffect)(()=>{I.length>0&&k(I)},[I]),(0,s.useEffect)(()=>{let e=async()=>{try{console.log("Setting up room...");let e="interview-".concat(Math.random().toString(36).substring(2,8));v(e);let r=await fetch("/api/agent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomName:e,participantName:"User"})});if(!r.ok)throw Error("Failed to get token");let n=await r.json();if(console.log("API Response:",n),!n.token||"string"!=typeof n.token)throw Error("Invalid token received from server");if(!n.wsUrl)throw Error("WebSocket URL not received from server");w(n.token),j(n.wsUrl),o(!0),R(!0);let s=null!=t?t:"Hello, I am Bob the Interviewer. How can I help you?";await O(s,"system")}catch(e){console.error("Error setting up room:",e),u(e instanceof Error?e.message:"Failed to connect to interview room")}};e()},[t]),(0,s.useEffect)(()=>{let e=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0});F.current=new MediaRecorder(e),F.current.ondataavailable=e=>{e.data.size>0&&L.current.push(e.data)},F.current.onstop=async()=>{D(!0);try{let e=new Blob(L.current,{type:"audio/wav"});L.current=[];let t=new FormData;t.append("audio",e,"recording.wav");let r=await fetch("/api/speech-to-text",{method:"POST",body:t});if(!r.ok)throw Error("Failed to transcribe audio");let{text:n}=await r.json();console.log("Transcribed text:",n),await O(n)}catch(e){console.error("Error processing audio:",e),u("Failed to process audio")}finally{D(!1)}}}catch(e){console.error("Error initializing media recorder:",e),u("Failed to access microphone")}};r&&e()},[r]),d)?(0,n.jsxs)("div",{className:"error-container",children:[(0,n.jsxs)("p",{children:["Error: ",d]}),(0,n.jsx)("button",{onClick:()=>window.location.reload(),children:"Retry Connection"})]}):r&&p&&g&&y?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h,{}),(0,n.jsx)("div",{className:"audio-chat-container",children:(0,n.jsxs)(a.L,{token:p,serverUrl:y,connect:!0,onConnected:()=>{console.log("Connected to LiveKit room:",g)},onDisconnected:()=>{console.log("Disconnected from LiveKit room:",g)},onError:e=>{console.error("LiveKit room error:",e),u(e.message)},children:[(0,n.jsxs)("div",{className:"chat-layout",children:[(0,n.jsxs)("div",{className:"chat-header",children:[(0,n.jsx)("h2",{children:"Interview with Bob"}),(0,n.jsxs)("div",{className:"status-indicator",children:[(0,n.jsx)("span",{className:"status-dot ".concat(r?"connected":"disconnected")}),r?"Connected":"Disconnected"]})]}),(0,n.jsxs)("div",{className:"messages-container",children:[S.map((e,t)=>(0,n.jsxs)("div",{className:"message-wrapper ".concat("user"===e.role?"user-message":"bob-message"),children:[(0,n.jsxs)("div",{className:"message-content",children:[(0,n.jsx)("div",{className:"message-sender",children:"system"===e.role||"assistant"===e.role?"Bob":"You"}),(0,n.jsx)("div",{className:"message-text",children:e.content})]}),(0,n.jsx)("div",{className:"message-timestamp",children:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t)),(0,n.jsx)("div",{ref:A})]}),(0,n.jsxs)("div",{className:"chat-controls",children:[(0,n.jsxs)("button",{className:"record-button ".concat(N?"recording":""," ").concat(E?"processing":""," ").concat(M?"interview-complete":""),onClick:()=>{if(!F.current){console.error("MediaRecorder not initialized");return}N?F.current.stop():(L.current=[],F.current.start()),b(!N)},disabled:E||M,children:[(0,n.jsx)("span",{className:"button-icon",children:N?"⏹":E?"⌛":M?"✅":"\uD83C\uDFA4"}),(0,n.jsx)("span",{className:"button-text",children:E?"Processing...":N?"Stop Recording":M?"Interview Complete":"Start Recording"})]}),M&&(0,n.jsxs)("button",{className:"new-interview-button",onClick:()=>window.location.reload(),children:[(0,n.jsx)("span",{className:"button-icon",children:"\uD83D\uDD04"}),(0,n.jsx)("span",{className:"button-text",children:"Start New Interview"})]})]})]}),(0,n.jsx)(c.R,{})]})})]}):(0,n.jsx)("div",{className:"loading-container",children:(0,n.jsxs)("div",{className:"loading-message",children:[(0,n.jsx)("div",{className:"robot-image-container",children:(0,n.jsx)(i(),{src:"/MegaRobotInterviewer.png",alt:"Robot Interviewer",width:480,height:480,priority:!0})}),(0,n.jsxs)("div",{className:"loading-text",children:[(0,n.jsx)(f,{text:"Hello! I'm your interviewer today. I'll be reviewing your resume and asking you some questions."}),(0,n.jsx)("h3",{children:"Connecting to interview room..."}),(0,n.jsx)("div",{className:"loading-spinner"})]})]})})},g=e=>{let{onChatStart:t}=e,[r,o]=(0,s.useState)(!1),[i,a]=(0,s.useState)(!1),[c,l]=(0,s.useState)(""),[d,u]=(0,s.useState)(!1),h=(0,s.useRef)(null);(0,s.useEffect)(()=>(r?(document.body.classList.add("chat-active"),null==t||t()):document.body.classList.remove("chat-active"),()=>{document.body.classList.remove("chat-active")}),[r,t]);let p=async e=>{var t;a(!0);let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!r){console.error("No file selected"),a(!1);return}await m(r)},m=async e=>{if("application/pdf"!==e.type){alert("Please upload a PDF file"),a(!1);return}let t=new FormData;t.append("file",e);try{let e=await fetch("/api/extract-text",{method:"POST",body:t});if(!e.ok)throw Error("Network response was not ok");let{text:r}=await e.json();l(r),o(!0)}catch(e){console.error("Error processing resume:",e)}finally{a(!1)}},x=async e=>{e.preventDefault(),e.stopPropagation(),u(!1),a(!0);let t=e.dataTransfer.files;t.length>0?await m(t[0]):a(!1)};return(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"instructions-text",children:r?"Answer Bob's questions using your microphone.":"Upload your resume to start the interview."}),r?(0,n.jsx)(w,{initialText:c}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"file-upload-btn-container ".concat(d?"dragging":""),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),u(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),u(!1)},onDrop:x,children:[(0,n.jsx)("input",{type:"file",id:"file-upload",onChange:p,accept:"application/pdf",hidden:!0,ref:h}),(0,n.jsxs)("label",{htmlFor:"file-upload",className:"file-upload-btn",children:["\uD83D\uDCC4 ",d?"Drop Resume Here":"Upload Resume"]}),(0,n.jsx)("p",{className:"drag-drop-hint",children:"or drag and drop a PDF file here"})]}),i&&(0,n.jsx)("div",{className:"loading-spinner"})]})]})};function v(){let[e,t]=(0,s.useState)(!1);return(0,n.jsxs)("main",{className:"App",children:[(0,n.jsx)(h,{}),(0,n.jsxs)("div",{className:"container",children:[(0,n.jsxs)("h1",{className:"app-title",children:["Interview",(0,n.jsx)("span",{className:"span-primary",children:"Pro"})]}),(0,n.jsx)("p",{className:"instructions-text",children:"Upload your resume and start a personalized interview session with our AI interviewer. Get real-time feedback and improve your interview skills."}),(0,n.jsx)(g,{onChatStart:()=>t(!0)}),!e&&(0,n.jsxs)("div",{className:"features-grid",children:[(0,n.jsxs)("div",{className:"feature-card",children:[(0,n.jsx)("div",{className:"feature-icon",children:"\uD83C\uDF99️"}),(0,n.jsx)("h3",{children:"Voice Interaction"}),(0,n.jsx)("p",{children:"Natural conversation with advanced speech recognition"})]}),(0,n.jsxs)("div",{className:"feature-card",children:[(0,n.jsx)("div",{className:"feature-icon",children:"\uD83E\uDDE0"}),(0,n.jsx)("h3",{children:"AI Feedback"}),(0,n.jsx)("p",{children:"Personalized guidance based on your responses"})]}),(0,n.jsxs)("div",{className:"feature-card",children:[(0,n.jsx)("div",{className:"feature-icon",children:"\uD83D\uDCDD"}),(0,n.jsx)("h3",{children:"Resume Analysis"}),(0,n.jsx)("p",{children:"Questions tailored to your experience and skills"})]})]})]})]})}}},function(e){e.O(0,[689,870,481,661,971,596,744],function(){return e(e.s=8588)}),_N_E=e.O()}]);